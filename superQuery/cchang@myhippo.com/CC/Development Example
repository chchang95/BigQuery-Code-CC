with x as (
select 
month_knowledge
,month_of_loss as accident_month
,month_first_notice_of_loss as report_month
,claim_number
,sum(loss_calculated_incurred_delta_this_month) as incurred_loss_incremental
,sum(expense_calculated_incurred_delta_this_month) as incurred_expense_incremental
,sum(total_incurred_delta_this_month) as incurred_total_incremental

,sum(loss_calculated_incurred_inception_to_date ) as incurred_loss_cumulative
,sum(expense_calculated_incurred_inception_to_date ) as incurred_expense_cumulative
,sum(total_incurred_inception_to_date ) as incurred_total_cumulative

,count(distinct claim_number) as reported_claim_count
,sum(case when date_close is null then 1 else 0 end) as open_claim_count
,sum(case when date_close is null then 0 else 1 end) as closed_claim_count
from dw_prod_extracts.ext_claim_monthly
where month_of_loss = '2020-04-01'
and month_knowledge = '2020-11-01'
and carrier <> 'canopius'
and is_ebsl is false
group by 1,2,3,4
order by 1,2,3
)
select * from x